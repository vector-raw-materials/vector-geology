<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.2 - Including GemPy &#8212; Vector Geology 0.3.dev17+g93b9dad.d20241008 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css?v=0ca0a429" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <script src="../../_static/documentation_options.js?v=8b60b743"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Probabilistic Inversion Example: Geological Model" href="02_model_1_bayesian.html" />
    <link rel="prev" title="Probabilistic Modeling" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-04-probabilistic-modeling-01-thickness-problem-gempy-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="including-gempy">
<span id="sphx-glr-examples-04-probabilistic-modeling-01-thickness-problem-gempy-py"></span><h1>2.2 - Including GemPy<a class="headerlink" href="#including-gempy" title="Link to this heading">¶</a></h1>
<section id="complex-probabilistic-model">
<h2>Complex probabilistic model<a class="headerlink" href="#complex-probabilistic-model" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">pyro</span>
<span class="kn">import</span> <span class="nn">pyro.distributions</span> <span class="k">as</span> <span class="nn">dist</span>
<span class="kn">from</span> <span class="nn">pyro.infer</span> <span class="kn">import</span> <span class="n">MCMC</span><span class="p">,</span> <span class="n">NUTS</span><span class="p">,</span> <span class="n">Predictive</span>
<span class="kn">from</span> <span class="nn">pyro.infer.autoguide</span> <span class="kn">import</span> <span class="n">init_to_mean</span>

<span class="kn">import</span> <span class="nn">gempy</span> <span class="k">as</span> <span class="nn">gp</span>
<span class="kn">import</span> <span class="nn">gempy_engine</span>
<span class="kn">import</span> <span class="nn">gempy_viewer</span> <span class="k">as</span> <span class="nn">gpv</span>
<span class="kn">from</span> <span class="nn">gempy_engine.core.backend_tensor</span> <span class="kn">import</span> <span class="n">BackendTensor</span>
<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">from</span> <span class="nn">gempy_probability.plot_posterior</span> <span class="kn">import</span> <span class="n">default_red</span><span class="p">,</span> <span class="n">default_blue</span>

<span class="kn">from</span> <span class="nn">gempy_viewer.modules.plot_2d.drawer_contours_2d</span> <span class="kn">import</span> <span class="n">plot_regular_grid_contacts</span>

<span class="c1"># sphinx_gallery_thumbnail_number = -1</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/bin/sphinx-build&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 339, in main
    return make_main(argv)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 213, in make_main
    return make_mode.run_make_mode(argv[1:])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 181, in run_make_mode
    return make.run_generic_build(args[0])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 169, in run_generic_build
    return build_main(args + opts)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 293, in build_main
    app = Sphinx(args.sourcedir, args.confdir, args.outputdir,
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 272, in __init__
    self._init_builder()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 343, in _init_builder
    self.events.emit(&#39;builder-inited&#39;)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/events.py&quot;, line 97, in emit
    results.append(listener.handler(self.app, *args))
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 632, in generate_gallery_rst
    ) = generate_dir_rst(src_dir, target_dir, gallery_conf, seen_backrefs)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 531, in generate_dir_rst
    intro, title, (t, mem) = generate_file_rst(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1203, in generate_file_rst
    output_blocks, time_elapsed = execute_script(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1108, in execute_script
    execute_code_block(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 970, in execute_code_block
    is_last_expr, mem_max = _exec_and_get_memory(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 818, in _exec_and_get_memory
    mem_max, _ = gallery_conf[&quot;call_memory&quot;](
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 244, in call_memory
    return 0.0, func()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 722, in __call__
    exec(self.code, self.fake_main.__dict__)
  File &quot;/home/leguark/vector-geology/examples/04_probabilistic_modeling/01_thickness_problem_gempy.py&quot;, line 22, in &lt;module&gt;
    import arviz as az
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/__init__.py&quot;, line 33, in &lt;module&gt;
    from .data import *
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/__init__.py&quot;, line 3, in &lt;module&gt;
    from .base import CoordSpec, DimSpec, dict_to_dataset, numpy_to_data_array, pytree_to_dataset
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/base.py&quot;, line 13, in &lt;module&gt;
    import xarray as xr
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/__init__.py&quot;, line 3, in &lt;module&gt;
    from xarray import groupers, testing, tutorial
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/groupers.py&quot;, line 17, in &lt;module&gt;
    from xarray.coding.cftime_offsets import BaseCFTimeOffset, _new_to_legacy_freq
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftime_offsets.py&quot;, line 56, in &lt;module&gt;
    from xarray.coding.cftimeindex import CFTimeIndex, _parse_iso8601_with_reso
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftimeindex.py&quot;, line 54, in &lt;module&gt;
    from xarray.coding.times import (
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/times.py&quot;, line 14, in &lt;module&gt;
    from xarray.coding.variables import (
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/variables.py&quot;, line 13, in &lt;module&gt;
    from xarray.core import dtypes, duck_array_ops, indexing
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/core/indexing.py&quot;, line 20, in &lt;module&gt;
    from xarray.core.types import T_Xarray
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/core/types.py&quot;, line 106, in &lt;module&gt;
    from cftime import datetime as CFTimeDatetime
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/cftime/__init__.py&quot;, line 1, in &lt;module&gt;
    from ._cftime import (datetime, real_datetime,

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/bin/sphinx-build&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 339, in main
    return make_main(argv)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 213, in make_main
    return make_mode.run_make_mode(argv[1:])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 181, in run_make_mode
    return make.run_generic_build(args[0])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 169, in run_generic_build
    return build_main(args + opts)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 293, in build_main
    app = Sphinx(args.sourcedir, args.confdir, args.outputdir,
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 272, in __init__
    self._init_builder()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 343, in _init_builder
    self.events.emit(&#39;builder-inited&#39;)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/events.py&quot;, line 97, in emit
    results.append(listener.handler(self.app, *args))
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 632, in generate_gallery_rst
    ) = generate_dir_rst(src_dir, target_dir, gallery_conf, seen_backrefs)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 531, in generate_dir_rst
    intro, title, (t, mem) = generate_file_rst(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1203, in generate_file_rst
    output_blocks, time_elapsed = execute_script(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1108, in execute_script
    execute_code_block(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 970, in execute_code_block
    is_last_expr, mem_max = _exec_and_get_memory(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 818, in _exec_and_get_memory
    mem_max, _ = gallery_conf[&quot;call_memory&quot;](
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 244, in call_memory
    return 0.0, func()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 722, in __call__
    exec(self.code, self.fake_main.__dict__)
  File &quot;/home/leguark/vector-geology/examples/04_probabilistic_modeling/01_thickness_problem_gempy.py&quot;, line 22, in &lt;module&gt;
    import arviz as az
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/__init__.py&quot;, line 33, in &lt;module&gt;
    from .data import *
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/__init__.py&quot;, line 3, in &lt;module&gt;
    from .base import CoordSpec, DimSpec, dict_to_dataset, numpy_to_data_array, pytree_to_dataset
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/base.py&quot;, line 13, in &lt;module&gt;
    import xarray as xr
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/__init__.py&quot;, line 3, in &lt;module&gt;
    from xarray import groupers, testing, tutorial
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/groupers.py&quot;, line 17, in &lt;module&gt;
    from xarray.coding.cftime_offsets import BaseCFTimeOffset, _new_to_legacy_freq
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftime_offsets.py&quot;, line 56, in &lt;module&gt;
    from xarray.coding.cftimeindex import CFTimeIndex, _parse_iso8601_with_reso
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftimeindex.py&quot;, line 54, in &lt;module&gt;
    from xarray.coding.times import (
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/times.py&quot;, line 14, in &lt;module&gt;
    from xarray.coding.variables import (
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/variables.py&quot;, line 14, in &lt;module&gt;
    from xarray.core.variable import Variable
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/core/variable.py&quot;, line 20, in &lt;module&gt;
    from xarray.core import common, dtypes, duck_array_ops, indexing, nputils, ops, utils
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/core/common.py&quot;, line 28, in &lt;module&gt;
    import cftime
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/cftime/__init__.py&quot;, line 1, in &lt;module&gt;
    from ._cftime import (datetime, real_datetime,

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/bin/sphinx-build&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 339, in main
    return make_main(argv)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 213, in make_main
    return make_mode.run_make_mode(argv[1:])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 181, in run_make_mode
    return make.run_generic_build(args[0])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 169, in run_generic_build
    return build_main(args + opts)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 293, in build_main
    app = Sphinx(args.sourcedir, args.confdir, args.outputdir,
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 272, in __init__
    self._init_builder()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 343, in _init_builder
    self.events.emit(&#39;builder-inited&#39;)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/events.py&quot;, line 97, in emit
    results.append(listener.handler(self.app, *args))
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 632, in generate_gallery_rst
    ) = generate_dir_rst(src_dir, target_dir, gallery_conf, seen_backrefs)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 531, in generate_dir_rst
    intro, title, (t, mem) = generate_file_rst(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1203, in generate_file_rst
    output_blocks, time_elapsed = execute_script(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1108, in execute_script
    execute_code_block(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 970, in execute_code_block
    is_last_expr, mem_max = _exec_and_get_memory(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 818, in _exec_and_get_memory
    mem_max, _ = gallery_conf[&quot;call_memory&quot;](
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 244, in call_memory
    return 0.0, func()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 722, in __call__
    exec(self.code, self.fake_main.__dict__)
  File &quot;/home/leguark/vector-geology/examples/04_probabilistic_modeling/01_thickness_problem_gempy.py&quot;, line 22, in &lt;module&gt;
    import arviz as az
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/__init__.py&quot;, line 33, in &lt;module&gt;
    from .data import *
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/__init__.py&quot;, line 3, in &lt;module&gt;
    from .base import CoordSpec, DimSpec, dict_to_dataset, numpy_to_data_array, pytree_to_dataset
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/base.py&quot;, line 13, in &lt;module&gt;
    import xarray as xr
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/__init__.py&quot;, line 3, in &lt;module&gt;
    from xarray import groupers, testing, tutorial
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/groupers.py&quot;, line 17, in &lt;module&gt;
    from xarray.coding.cftime_offsets import BaseCFTimeOffset, _new_to_legacy_freq
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftime_offsets.py&quot;, line 56, in &lt;module&gt;
    from xarray.coding.cftimeindex import CFTimeIndex, _parse_iso8601_with_reso
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftimeindex.py&quot;, line 54, in &lt;module&gt;
    from xarray.coding.times import (
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/times.py&quot;, line 35, in &lt;module&gt;
    import cftime
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/cftime/__init__.py&quot;, line 1, in &lt;module&gt;
    from ._cftime import (datetime, real_datetime,

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/bin/sphinx-build&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 339, in main
    return make_main(argv)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 213, in make_main
    return make_mode.run_make_mode(argv[1:])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 181, in run_make_mode
    return make.run_generic_build(args[0])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 169, in run_generic_build
    return build_main(args + opts)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 293, in build_main
    app = Sphinx(args.sourcedir, args.confdir, args.outputdir,
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 272, in __init__
    self._init_builder()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 343, in _init_builder
    self.events.emit(&#39;builder-inited&#39;)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/events.py&quot;, line 97, in emit
    results.append(listener.handler(self.app, *args))
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 632, in generate_gallery_rst
    ) = generate_dir_rst(src_dir, target_dir, gallery_conf, seen_backrefs)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 531, in generate_dir_rst
    intro, title, (t, mem) = generate_file_rst(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1203, in generate_file_rst
    output_blocks, time_elapsed = execute_script(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1108, in execute_script
    execute_code_block(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 970, in execute_code_block
    is_last_expr, mem_max = _exec_and_get_memory(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 818, in _exec_and_get_memory
    mem_max, _ = gallery_conf[&quot;call_memory&quot;](
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 244, in call_memory
    return 0.0, func()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 722, in __call__
    exec(self.code, self.fake_main.__dict__)
  File &quot;/home/leguark/vector-geology/examples/04_probabilistic_modeling/01_thickness_problem_gempy.py&quot;, line 22, in &lt;module&gt;
    import arviz as az
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/__init__.py&quot;, line 33, in &lt;module&gt;
    from .data import *
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/__init__.py&quot;, line 3, in &lt;module&gt;
    from .base import CoordSpec, DimSpec, dict_to_dataset, numpy_to_data_array, pytree_to_dataset
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/base.py&quot;, line 13, in &lt;module&gt;
    import xarray as xr
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/__init__.py&quot;, line 3, in &lt;module&gt;
    from xarray import groupers, testing, tutorial
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/groupers.py&quot;, line 17, in &lt;module&gt;
    from xarray.coding.cftime_offsets import BaseCFTimeOffset, _new_to_legacy_freq
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftime_offsets.py&quot;, line 56, in &lt;module&gt;
    from xarray.coding.cftimeindex import CFTimeIndex, _parse_iso8601_with_reso
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftimeindex.py&quot;, line 64, in &lt;module&gt;
    import cftime
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/cftime/__init__.py&quot;, line 1, in &lt;module&gt;
    from ._cftime import (datetime, real_datetime,

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/bin/sphinx-build&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 339, in main
    return make_main(argv)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 213, in make_main
    return make_mode.run_make_mode(argv[1:])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 181, in run_make_mode
    return make.run_generic_build(args[0])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 169, in run_generic_build
    return build_main(args + opts)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 293, in build_main
    app = Sphinx(args.sourcedir, args.confdir, args.outputdir,
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 272, in __init__
    self._init_builder()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 343, in _init_builder
    self.events.emit(&#39;builder-inited&#39;)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/events.py&quot;, line 97, in emit
    results.append(listener.handler(self.app, *args))
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 632, in generate_gallery_rst
    ) = generate_dir_rst(src_dir, target_dir, gallery_conf, seen_backrefs)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 531, in generate_dir_rst
    intro, title, (t, mem) = generate_file_rst(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1203, in generate_file_rst
    output_blocks, time_elapsed = execute_script(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1108, in execute_script
    execute_code_block(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 970, in execute_code_block
    is_last_expr, mem_max = _exec_and_get_memory(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 818, in _exec_and_get_memory
    mem_max, _ = gallery_conf[&quot;call_memory&quot;](
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 244, in call_memory
    return 0.0, func()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 722, in __call__
    exec(self.code, self.fake_main.__dict__)
  File &quot;/home/leguark/vector-geology/examples/04_probabilistic_modeling/01_thickness_problem_gempy.py&quot;, line 22, in &lt;module&gt;
    import arviz as az
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/__init__.py&quot;, line 33, in &lt;module&gt;
    from .data import *
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/__init__.py&quot;, line 3, in &lt;module&gt;
    from .base import CoordSpec, DimSpec, dict_to_dataset, numpy_to_data_array, pytree_to_dataset
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/base.py&quot;, line 13, in &lt;module&gt;
    import xarray as xr
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/__init__.py&quot;, line 3, in &lt;module&gt;
    from xarray import groupers, testing, tutorial
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/groupers.py&quot;, line 17, in &lt;module&gt;
    from xarray.coding.cftime_offsets import BaseCFTimeOffset, _new_to_legacy_freq
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/cftime_offsets.py&quot;, line 73, in &lt;module&gt;
    import cftime
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/cftime/__init__.py&quot;, line 1, in &lt;module&gt;
    from ._cftime import (datetime, real_datetime,

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/bin/sphinx-build&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 339, in main
    return make_main(argv)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 213, in make_main
    return make_mode.run_make_mode(argv[1:])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 181, in run_make_mode
    return make.run_generic_build(args[0])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 169, in run_generic_build
    return build_main(args + opts)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 293, in build_main
    app = Sphinx(args.sourcedir, args.confdir, args.outputdir,
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 272, in __init__
    self._init_builder()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 343, in _init_builder
    self.events.emit(&#39;builder-inited&#39;)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/events.py&quot;, line 97, in emit
    results.append(listener.handler(self.app, *args))
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 632, in generate_gallery_rst
    ) = generate_dir_rst(src_dir, target_dir, gallery_conf, seen_backrefs)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 531, in generate_dir_rst
    intro, title, (t, mem) = generate_file_rst(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1203, in generate_file_rst
    output_blocks, time_elapsed = execute_script(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1108, in execute_script
    execute_code_block(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 970, in execute_code_block
    is_last_expr, mem_max = _exec_and_get_memory(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 818, in _exec_and_get_memory
    mem_max, _ = gallery_conf[&quot;call_memory&quot;](
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 244, in call_memory
    return 0.0, func()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 722, in __call__
    exec(self.code, self.fake_main.__dict__)
  File &quot;/home/leguark/vector-geology/examples/04_probabilistic_modeling/01_thickness_problem_gempy.py&quot;, line 22, in &lt;module&gt;
    import arviz as az
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/__init__.py&quot;, line 33, in &lt;module&gt;
    from .data import *
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/__init__.py&quot;, line 3, in &lt;module&gt;
    from .base import CoordSpec, DimSpec, dict_to_dataset, numpy_to_data_array, pytree_to_dataset
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/base.py&quot;, line 13, in &lt;module&gt;
    import xarray as xr
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/__init__.py&quot;, line 3, in &lt;module&gt;
    from xarray import groupers, testing, tutorial
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/groupers.py&quot;, line 20, in &lt;module&gt;
    from xarray.core.dataarray import DataArray
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/core/dataarray.py&quot;, line 29, in &lt;module&gt;
    from xarray.coding.calendar_ops import convert_calendar, interp_calendar
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/coding/calendar_ops.py&quot;, line 20, in &lt;module&gt;
    import cftime
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/cftime/__init__.py&quot;, line 1, in &lt;module&gt;
    from ._cftime import (datetime, real_datetime,

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/bin/sphinx-build&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 339, in main
    return make_main(argv)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 213, in make_main
    return make_mode.run_make_mode(argv[1:])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 181, in run_make_mode
    return make.run_generic_build(args[0])
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/make_mode.py&quot;, line 169, in run_generic_build
    return build_main(args + opts)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/cmd/build.py&quot;, line 293, in build_main
    app = Sphinx(args.sourcedir, args.confdir, args.outputdir,
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 272, in __init__
    self._init_builder()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/application.py&quot;, line 343, in _init_builder
    self.events.emit(&#39;builder-inited&#39;)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx/events.py&quot;, line 97, in emit
    results.append(listener.handler(self.app, *args))
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 632, in generate_gallery_rst
    ) = generate_dir_rst(src_dir, target_dir, gallery_conf, seen_backrefs)
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 531, in generate_dir_rst
    intro, title, (t, mem) = generate_file_rst(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1203, in generate_file_rst
    output_blocks, time_elapsed = execute_script(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 1108, in execute_script
    execute_code_block(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 970, in execute_code_block
    is_last_expr, mem_max = _exec_and_get_memory(
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 818, in _exec_and_get_memory
    mem_max, _ = gallery_conf[&quot;call_memory&quot;](
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_gallery.py&quot;, line 244, in call_memory
    return 0.0, func()
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/sphinx_gallery/gen_rst.py&quot;, line 722, in __call__
    exec(self.code, self.fake_main.__dict__)
  File &quot;/home/leguark/vector-geology/examples/04_probabilistic_modeling/01_thickness_problem_gempy.py&quot;, line 22, in &lt;module&gt;
    import arviz as az
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/__init__.py&quot;, line 33, in &lt;module&gt;
    from .data import *
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/__init__.py&quot;, line 3, in &lt;module&gt;
    from .base import CoordSpec, DimSpec, dict_to_dataset, numpy_to_data_array, pytree_to_dataset
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/base.py&quot;, line 13, in &lt;module&gt;
    import xarray as xr
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/__init__.py&quot;, line 3, in &lt;module&gt;
    from xarray import groupers, testing, tutorial
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/groupers.py&quot;, line 20, in &lt;module&gt;
    from xarray.core.dataarray import DataArray
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/core/dataarray.py&quot;, line 49, in &lt;module&gt;
    from xarray.core.dataset import Dataset
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/core/dataset.py&quot;, line 131, in &lt;module&gt;
    from xarray.plot.accessor import DatasetPlotAccessor
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/plot/__init__.py&quot;, line 10, in &lt;module&gt;
    from xarray.plot.dataarray_plot import (
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/plot/dataarray_plot.py&quot;, line 13, in &lt;module&gt;
    from xarray.plot.facetgrid import _easy_facetgrid
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/plot/facetgrid.py&quot;, line 13, in &lt;module&gt;
    from xarray.plot.utils import (
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/xarray/plot/utils.py&quot;, line 30, in &lt;module&gt;
    import cftime
  File &quot;/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/cftime/__init__.py&quot;, line 1, in &lt;module&gt;
    from ._cftime import (datetime, real_datetime,
</pre></div>
</div>
<p>Config</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">seed</span> <span class="o">=</span> <span class="mi">123456</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">pyro</span><span class="o">.</span><span class="n">set_rng_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
<p>Set the data path</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Define a function for plotting geological settings with wells</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_geo_setting_well</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">show_lith</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function plots the geological settings along with the well locations.</span>
<span class="sd">    It uses gempy_viewer to create 2D plots of the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define well and device locations</span>
    <span class="n">device_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">6e3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3700</span><span class="p">]])</span>
    <span class="n">well_1</span> <span class="o">=</span> <span class="mf">3.41e3</span>
    <span class="n">well_2</span> <span class="o">=</span> <span class="mf">3.6e3</span>

    <span class="c1"># Create a 2D plot</span>
    <span class="n">p2d</span> <span class="o">=</span> <span class="n">gpv</span><span class="o">.</span><span class="n">plot_2d</span><span class="p">(</span>
        <span class="n">geo_model</span><span class="p">,</span>
        <span class="n">show_topography</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">show_lith</span><span class="o">=</span><span class="n">show_lith</span><span class="p">,</span>
        <span class="n">kwargs_boundaries</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Add well and device markers to the plot</span>
    <span class="n">p2d</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mf">3e3</span><span class="p">],</span> <span class="p">[</span><span class="n">well_1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#71a4b3&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">p2d</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mf">9e3</span><span class="p">],</span> <span class="p">[</span><span class="n">well_2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#71a4b3&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">p2d</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">device_loc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">device_loc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#DA8886&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Add vertical lines to represent wells</span>
    <span class="n">p2d</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">3e3</span><span class="p">,</span> <span class="mf">.5e3</span><span class="p">,</span> <span class="n">well_1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">p2d</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">9e3</span><span class="p">,</span> <span class="mf">.5e3</span><span class="p">,</span> <span class="n">well_2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

    <span class="c1"># Show the plot</span>
    <span class="n">p2d</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">p2d</span>
</pre></div>
</div>
</section>
<section id="creating-the-geological-model">
<h2>Creating the Geological Model<a class="headerlink" href="#creating-the-geological-model" title="Link to this heading">¶</a></h2>
<p>Here we create a geological model using GemPy. The model defines the spatial extent,
resolution, and geological information derived from orientations and surface points data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">create_geomodel</span><span class="p">(</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s1">&#39;Wells&#39;</span><span class="p">,</span>
    <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12000</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">],</span>
    <span class="n">resolution</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="c1"># refinement=1,</span>
    <span class="n">importer_helper</span><span class="o">=</span><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ImporterHelper</span><span class="p">(</span>
        <span class="n">path_to_orientations</span><span class="o">=</span><span class="n">data_path</span> <span class="o">+</span> <span class="s2">&quot;/data/2-layers/2-layers_orientations.csv&quot;</span><span class="p">,</span>
        <span class="n">path_to_surface_points</span><span class="o">=</span><span class="n">data_path</span> <span class="o">+</span> <span class="s2">&quot;/data/2-layers/2-layers_surface_points.csv&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="configuring-the-model">
<h2>Configuring the Model<a class="headerlink" href="#configuring-the-model" title="Link to this heading">¶</a></h2>
<p>We configure the interpolation options for the geological model.
These options determine how the model interpolates between data points.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">geo_model</span><span class="o">.</span><span class="n">interpolation_options</span><span class="o">.</span><span class="n">uni_degree</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">interpolation_options</span><span class="o">.</span><span class="n">mesh_extraction</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">geo_model</span><span class="o">.</span><span class="n">interpolation_options</span><span class="o">.</span><span class="n">sigmoid_slope</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># ! Temporary fix to set the hard sigmoid</span>
</pre></div>
</div>
</section>
<section id="setting-up-a-custom-grid">
<h2>Setting up a Custom Grid<a class="headerlink" href="#setting-up-a-custom-grid" title="Link to this heading">¶</a></h2>
<p>A custom grid is set for the model, defining specific points in space
where geological formations will be evaluated.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">x_loc</span> <span class="o">=</span> <span class="mi">6000</span>
<span class="n">y_loc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">z_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">xyz_coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x_loc</span><span class="p">,</span> <span class="n">y_loc</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">z_loc</span><span class="p">])</span>
<span class="n">gp</span><span class="o">.</span><span class="n">set_custom_grid</span><span class="p">(</span><span class="n">geo_model</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">xyz_coord</span><span class="o">=</span><span class="n">xyz_coord</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Active grids: GridTypes.NONE|CUSTOM|DENSE

&lt;gempy.core.data.grid_modules.grid_types.CustomGrid object at 0x7f27af42b850&gt;
</pre></div>
</div>
</section>
<section id="plotting-the-initial-geological-setting">
<h2>Plotting the Initial Geological Setting<a class="headerlink" href="#plotting-the-initial-geological-setting" title="Link to this heading">¶</a></h2>
<p>Before running any probabilistic analysis, we first visualize the initial geological setting.
This step ensures that our model is correctly set up with the initial data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot initial geological settings</span>
<span class="n">plot_geo_setting_well</span><span class="p">(</span><span class="n">geo_model</span><span class="o">=</span><span class="n">geo_model</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_01_thickness_problem_gempy_001.png" srcset="../../_images/sphx_glr_01_thickness_problem_gempy_001.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;gempy_viewer.modules.plot_2d.visualization_2d.Plot2D object at 0x7f280b0e6f80&gt;
</pre></div>
</div>
</section>
<section id="interpolating-the-initial-guess">
<h2>Interpolating the Initial Guess<a class="headerlink" href="#interpolating-the-initial-guess" title="Link to this heading">¶</a></h2>
<p>The model interpolates an initial guess for the geological formations.
This step is crucial to provide a starting point for further probabilistic analysis.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span>
    <span class="n">gempy_model</span><span class="o">=</span><span class="n">geo_model</span><span class="p">,</span>
    <span class="n">engine_config</span><span class="o">=</span><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">GemPyEngineConfig</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">AvailableBackends</span><span class="o">.</span><span class="n">numpy</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plot_geo_setting_well</span><span class="p">(</span><span class="n">geo_model</span><span class="o">=</span><span class="n">geo_model</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_01_thickness_problem_gempy_002.png" srcset="../../_images/sphx_glr_01_thickness_problem_gempy_002.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting Backend To: AvailableBackends.numpy

&lt;gempy_viewer.modules.plot_2d.visualization_2d.Plot2D object at 0x7f27ad1b15a0&gt;
</pre></div>
</div>
</section>
<section id="probabilistic-geomodeling-with-pyro">
<h2>Probabilistic Geomodeling with Pyro<a class="headerlink" href="#probabilistic-geomodeling-with-pyro" title="Link to this heading">¶</a></h2>
<p>In this section, we introduce a probabilistic approach to geological modeling.
By using Pyro, a probabilistic programming language, we define a model that integrates
geological data with uncertainty quantification.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sp_coords_copy</span> <span class="o">=</span> <span class="n">geo_model</span><span class="o">.</span><span class="n">interpolation_input_copy</span><span class="o">.</span><span class="n">surface_points</span><span class="o">.</span><span class="n">sp_coords</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Change the backend to PyTorch for probabilistic modeling</span>
<span class="n">BackendTensor</span><span class="o">.</span><span class="n">change_backend_gempy</span><span class="p">(</span><span class="n">engine_backend</span><span class="o">=</span><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">AvailableBackends</span><span class="o">.</span><span class="n">PYTORCH</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting Backend To: AvailableBackends.PYTORCH
</pre></div>
</div>
</section>
<section id="defining-the-probabilistic-model">
<h2>Defining the Probabilistic Model<a class="headerlink" href="#defining-the-probabilistic-model" title="Link to this heading">¶</a></h2>
<p>The Pyro model represents the probabilistic aspects of the geological model.
It defines a prior distribution for the top layer’s location and computes the thickness
of the geological layer as an observed variable.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">y_obs_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This Pyro model represents the probabilistic aspects of the geological model.</span>
<span class="sd">    It defines a prior distribution for the top layer&#39;s location and</span>
<span class="sd">    computes the thickness of the geological layer as an observed variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define prior for the top layer&#39;s location</span>
    <span class="n">prior_mean</span> <span class="o">=</span> <span class="n">sp_coords_copy</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">mu_top</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu_</span><span class="si">{top}</span><span class="s1">$&#39;</span><span class="p">,</span>
        <span class="n">fn</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">prior_mean</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="c1"># Update the model with the new top layer&#39;s location</span>
    <span class="n">interpolation_input</span> <span class="o">=</span> <span class="n">geo_model</span><span class="o">.</span><span class="n">interpolation_input_copy</span>
    <span class="n">interpolation_input</span><span class="o">.</span><span class="n">surface_points</span><span class="o">.</span><span class="n">sp_coords</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">index_put</span><span class="p">(</span>
        <span class="n">interpolation_input</span><span class="o">.</span><span class="n">surface_points</span><span class="o">.</span><span class="n">sp_coords</span><span class="p">,</span>
        <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">])),</span>
        <span class="n">mu_top</span>
    <span class="p">)</span>

    <span class="c1"># Compute the geological model</span>
    <span class="n">geo_model</span><span class="o">.</span><span class="n">solutions</span> <span class="o">=</span> <span class="n">gempy_engine</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span>
        <span class="n">interpolation_input</span><span class="o">=</span><span class="n">interpolation_input</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">geo_model</span><span class="o">.</span><span class="n">interpolation_options</span><span class="p">,</span>
        <span class="n">data_descriptor</span><span class="o">=</span><span class="n">geo_model</span><span class="o">.</span><span class="n">input_data_descriptor</span><span class="p">,</span>
        <span class="n">geophysics_input</span><span class="o">=</span><span class="n">geo_model</span><span class="o">.</span><span class="n">geophysics_input</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Compute and observe the thickness of the geological layer</span>
    <span class="n">simulated_well</span> <span class="o">=</span> <span class="n">geo_model</span><span class="o">.</span><span class="n">solutions</span><span class="o">.</span><span class="n">octrees_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">last_output_center</span><span class="o">.</span><span class="n">custom_grid_values</span>
    <span class="n">thickness</span> <span class="o">=</span> <span class="n">simulated_well</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">pyro</span><span class="o">.</span><span class="n">deterministic</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu_</span><span class="si">{thickness}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">.</span><span class="n">detach</span><span class="p">())</span>
    <span class="n">y_thickness</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y_</span><span class="si">{thickness}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">thickness</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">y_obs_list</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="running-prior-sampling-and-visualization">
<h2>Running Prior Sampling and Visualization<a class="headerlink" href="#running-prior-sampling-and-visualization" title="Link to this heading">¶</a></h2>
<p>Prior sampling is an essential step in probabilistic modeling.
It helps in understanding the distribution of our prior assumptions before observing any data.</p>
<p>Prepare observation data</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">y_obs_list</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">190</span><span class="p">])</span>
</pre></div>
</div>
<p>Run prior sampling and visualization</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">prior</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">50</span><span class="p">)(</span><span class="n">y_obs_list</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_pyro</span><span class="p">(</span><span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">)</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">prior</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_01_thickness_problem_gempy_003.png" srcset="../../_images/sphx_glr_01_thickness_problem_gempy_003.png" alt="$\mu_{thickness}$, $\mu_{thickness}$, $\mu_{top}$, $\mu_{top}$, $y_{thickness}$, $y_{thickness}$" class = "sphx-glr-single-img"/></section>
<section id="sampling-from-the-posterior-using-mcmc">
<h2>Sampling from the Posterior using MCMC<a class="headerlink" href="#sampling-from-the-posterior-using-mcmc" title="Link to this heading">¶</a></h2>
<p>We use Markov Chain Monte Carlo (MCMC) with the NUTS (No-U-Turn Sampler) algorithm
to sample from the posterior distribution. This gives us an understanding of the
distribution of our model parameters after considering the observed data.</p>
<p>Run MCMC using NUTS to sample from the posterior</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Magic sauce</span>
<span class="kn">from</span> <span class="nn">gempy_engine.core.backend_tensor</span> <span class="kn">import</span> <span class="n">BackendTensor</span>

<span class="c1"># import gempy_engine.config</span>
<span class="c1"># config.DEFAULT_PYKEOPS = False</span>
<span class="n">BackendTensor</span><span class="o">.</span><span class="n">_change_backend</span><span class="p">(</span>
    <span class="n">engine_backend</span><span class="o">=</span><span class="n">gp</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">AvailableBackends</span><span class="o">.</span><span class="n">PYTORCH</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">,</span>
    <span class="n">pykeops_enabled</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">pyro</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">enable_validation</span><span class="p">(</span><span class="n">is_validate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nuts_kernel</span> <span class="o">=</span> <span class="n">NUTS</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mf">0.0085</span><span class="p">,</span> <span class="n">adapt_step_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">target_accept_prob</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">max_tree_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">init_strategy</span><span class="o">=</span><span class="n">init_to_mean</span><span class="p">)</span>
<span class="n">mcmc</span> <span class="o">=</span> <span class="n">MCMC</span><span class="p">(</span><span class="n">nuts_kernel</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">warmup_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">y_obs_list</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting Backend To: AvailableBackends.PYTORCH

Warmup:   0%|          | 0/250 [00:00, ?it/s]
Warmup:   0%|          | 1/250 [00:00,  1.31it/s, step size=1.32e-01, acc. prob=0.000]
Warmup:   2%|▏         | 4/250 [00:01,  3.83it/s, step size=6.85e-03, acc. prob=0.498]
Warmup:   2%|▏         | 5/250 [00:01,  3.50it/s, step size=6.86e-03, acc. prob=0.592]
Warmup:   2%|▏         | 6/250 [00:01,  4.21it/s, step size=8.19e-03, acc. prob=0.659]
Warmup:   3%|▎         | 7/250 [00:01,  4.15it/s, step size=9.21e-03, acc. prob=0.703]
Warmup:   3%|▎         | 8/250 [00:02,  4.95it/s, step size=9.81e-03, acc. prob=0.731]
Warmup:   4%|▎         | 9/250 [00:02,  5.77it/s, step size=1.27e-02, acc. prob=0.760]
Warmup:   4%|▍         | 10/250 [00:02,  5.12it/s, step size=1.70e-02, acc. prob=0.783]
Warmup:   4%|▍         | 11/250 [00:02,  4.73it/s, step size=2.34e-02, acc. prob=0.803]
Warmup:   5%|▍         | 12/250 [00:02,  5.56it/s, step size=1.94e-02, acc. prob=0.806]
Warmup:   5%|▌         | 13/250 [00:02,  6.17it/s, step size=1.92e-02, acc. prob=0.813]
Warmup:   6%|▋         | 16/250 [00:02, 10.85it/s, step size=1.80e-02, acc. prob=0.826]
Warmup:   8%|▊         | 19/250 [00:03, 14.95it/s, step size=2.88e-02, acc. prob=0.845]
Warmup:   9%|▉         | 22/250 [00:03, 18.46it/s, step size=3.42e-03, acc. prob=0.818]
Warmup:  10%|█         | 25/250 [00:04,  5.78it/s, step size=8.64e-03, acc. prob=0.839]
Warmup:  11%|█         | 27/250 [00:04,  6.82it/s, step size=1.45e-02, acc. prob=0.849]
Warmup:  12%|█▏        | 29/250 [00:04,  5.82it/s, step size=1.89e-02, acc. prob=0.855]
Warmup:  12%|█▏        | 31/250 [00:05,  6.61it/s, step size=3.36e-02, acc. prob=0.864]
Warmup:  13%|█▎        | 33/250 [00:05,  7.81it/s, step size=9.68e-03, acc. prob=0.852]
Warmup:  14%|█▍        | 35/250 [00:05,  8.99it/s, step size=1.74e-02, acc. prob=0.860]
Warmup:  15%|█▍        | 37/250 [00:05,  7.80it/s, step size=1.31e-02, acc. prob=0.859]
Warmup:  16%|█▌        | 39/250 [00:06,  7.76it/s, step size=2.29e-02, acc. prob=0.866]
Warmup:  16%|█▌        | 40/250 [00:06,  8.03it/s, step size=3.03e-02, acc. prob=0.869]
Warmup:  17%|█▋        | 42/250 [00:06,  7.73it/s, step size=9.41e-03, acc. prob=0.859]
Warmup:  17%|█▋        | 43/250 [00:06,  6.77it/s, step size=1.22e-02, acc. prob=0.862]
Warmup:  18%|█▊        | 44/250 [00:07,  3.86it/s, step size=2.01e+00, acc. prob=0.865]
Warmup:  19%|█▉        | 47/250 [00:07,  5.39it/s, step size=3.15e-01, acc. prob=0.834]
Warmup:  19%|█▉        | 48/250 [00:07,  4.98it/s, step size=3.07e-01, acc. prob=0.838]
Warmup:  20%|█▉        | 49/250 [00:07,  5.46it/s, step size=4.44e-01, acc. prob=0.841]
Warmup:  20%|██        | 50/250 [00:08,  4.97it/s, step size=4.44e-01, acc. prob=0.843]
Warmup:  20%|██        | 51/250 [00:08,  4.62it/s, step size=4.44e-01, acc. prob=0.967]
Sample:  21%|██        | 52/250 [00:08,  4.19it/s, step size=4.44e-01, acc. prob=0.983]
Sample:  21%|██        | 53/250 [00:09,  3.84it/s, step size=4.44e-01, acc. prob=0.971]
Sample:  22%|██▏       | 54/250 [00:09,  4.49it/s, step size=4.44e-01, acc. prob=0.978]
Sample:  22%|██▏       | 55/250 [00:09,  5.22it/s, step size=4.44e-01, acc. prob=0.981]
Sample:  22%|██▏       | 56/250 [00:09,  4.80it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  23%|██▎       | 57/250 [00:09,  4.77it/s, step size=4.44e-01, acc. prob=0.983]
Sample:  23%|██▎       | 58/250 [00:10,  4.28it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  24%|██▎       | 59/250 [00:10,  4.91it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  24%|██▍       | 60/250 [00:10,  5.41it/s, step size=4.44e-01, acc. prob=0.988]
Sample:  24%|██▍       | 61/250 [00:10,  4.37it/s, step size=4.44e-01, acc. prob=0.979]
Sample:  26%|██▌       | 64/250 [00:10,  7.32it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  26%|██▌       | 65/250 [00:11,  7.48it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  26%|██▋       | 66/250 [00:11,  6.24it/s, step size=4.44e-01, acc. prob=0.985]
Sample:  27%|██▋       | 67/250 [00:11,  6.77it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  27%|██▋       | 68/250 [00:11,  5.77it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  28%|██▊       | 69/250 [00:11,  6.46it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  28%|██▊       | 70/250 [00:12,  5.49it/s, step size=4.44e-01, acc. prob=0.985]
Sample:  28%|██▊       | 71/250 [00:12,  6.22it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  29%|██▉       | 73/250 [00:12,  8.28it/s, step size=4.44e-01, acc. prob=0.985]
Sample:  30%|███       | 75/250 [00:12,  9.76it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  31%|███       | 77/250 [00:12,  7.69it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  31%|███       | 78/250 [00:12,  7.99it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  32%|███▏      | 79/250 [00:13,  6.42it/s, step size=4.44e-01, acc. prob=0.982]
Sample:  32%|███▏      | 80/250 [00:13,  5.61it/s, step size=4.44e-01, acc. prob=0.983]
Sample:  32%|███▏      | 81/250 [00:13,  6.31it/s, step size=4.44e-01, acc. prob=0.983]
Sample:  33%|███▎      | 82/250 [00:13,  5.43it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  33%|███▎      | 83/250 [00:13,  6.16it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  34%|███▎      | 84/250 [00:14,  5.45it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  34%|███▍      | 85/250 [00:14,  5.46it/s, step size=4.44e-01, acc. prob=0.984]
Sample:  34%|███▍      | 86/250 [00:14,  4.84it/s, step size=4.44e-01, acc. prob=0.985]
Sample:  35%|███▍      | 87/250 [00:14,  5.61it/s, step size=4.44e-01, acc. prob=0.985]
Sample:  36%|███▌      | 89/250 [00:14,  6.09it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  36%|███▌      | 90/250 [00:15,  5.90it/s, step size=4.44e-01, acc. prob=0.985]
Sample:  36%|███▋      | 91/250 [00:15,  5.23it/s, step size=4.44e-01, acc. prob=0.985]
Sample:  37%|███▋      | 92/250 [00:15,  5.92it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  37%|███▋      | 93/250 [00:15,  6.57it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  38%|███▊      | 94/250 [00:15,  5.53it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  38%|███▊      | 95/250 [00:16,  5.43it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  39%|███▉      | 97/250 [00:16,  5.89it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  39%|███▉      | 98/250 [00:16,  5.27it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  40%|███▉      | 99/250 [00:16,  4.89it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  40%|████      | 100/250 [00:17,  4.54it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  40%|████      | 101/250 [00:17,  4.77it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  41%|████      | 102/250 [00:17,  4.98it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  41%|████      | 103/250 [00:17,  5.72it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  42%|████▏     | 104/250 [00:17,  5.69it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  42%|████▏     | 105/250 [00:18,  4.98it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  43%|████▎     | 108/250 [00:18,  9.15it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  44%|████▍     | 111/250 [00:18, 11.43it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  45%|████▌     | 113/250 [00:18,  8.63it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  46%|████▌     | 115/250 [00:19,  5.90it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  46%|████▋     | 116/250 [00:19,  6.30it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  47%|████▋     | 117/250 [00:19,  5.55it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  48%|████▊     | 120/250 [00:19,  7.96it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  48%|████▊     | 121/250 [00:20,  6.74it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  49%|████▉     | 122/250 [00:20,  5.83it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  49%|████▉     | 123/250 [00:20,  5.79it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  50%|████▉     | 124/250 [00:20,  5.64it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  50%|█████     | 125/250 [00:20,  5.02it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  50%|█████     | 126/250 [00:21,  3.41it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  51%|█████     | 128/250 [00:21,  4.35it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  52%|█████▏    | 129/250 [00:21,  4.95it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  52%|█████▏    | 130/250 [00:22,  4.62it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  52%|█████▏    | 131/250 [00:22,  4.45it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  53%|█████▎    | 132/250 [00:22,  4.36it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  53%|█████▎    | 133/250 [00:22,  4.32it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  54%|█████▎    | 134/250 [00:23,  5.13it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  54%|█████▍    | 135/250 [00:23,  5.90it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  55%|█████▍    | 137/250 [00:23,  6.32it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  55%|█████▌    | 138/250 [00:23,  5.54it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  56%|█████▌    | 139/250 [00:23,  6.14it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  56%|█████▌    | 140/250 [00:23,  6.71it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  56%|█████▋    | 141/250 [00:24,  5.61it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  57%|█████▋    | 142/250 [00:24,  4.99it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  57%|█████▋    | 143/250 [00:24,  4.63it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  58%|█████▊    | 144/250 [00:24,  5.42it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  58%|█████▊    | 145/250 [00:24,  5.42it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  58%|█████▊    | 146/250 [00:25,  4.82it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  59%|█████▉    | 147/250 [00:25,  5.57it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  59%|█████▉    | 148/250 [00:25,  4.94it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  60%|█████▉    | 149/250 [00:25,  5.72it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  60%|██████    | 150/250 [00:25,  6.41it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  61%|██████    | 152/250 [00:26,  7.40it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  61%|██████    | 153/250 [00:26,  6.02it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  62%|██████▏   | 154/250 [00:26,  5.29it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  62%|██████▏   | 156/250 [00:26,  5.78it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  63%|██████▎   | 157/250 [00:27,  5.69it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  63%|██████▎   | 158/250 [00:27,  5.13it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  64%|██████▎   | 159/250 [00:27,  4.74it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  64%|██████▍   | 160/250 [00:27,  4.90it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  64%|██████▍   | 161/250 [00:27,  4.53it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  65%|██████▍   | 162/250 [00:28,  5.29it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  65%|██████▌   | 163/250 [00:28,  6.01it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  66%|██████▌   | 164/250 [00:28,  3.58it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  66%|██████▌   | 165/250 [00:28,  3.99it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  67%|██████▋   | 167/250 [00:29,  4.92it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  67%|██████▋   | 168/250 [00:29,  4.60it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  68%|██████▊   | 169/250 [00:29,  4.43it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  68%|██████▊   | 170/250 [00:29,  4.31it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  68%|██████▊   | 171/250 [00:30,  4.21it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  69%|██████▉   | 172/250 [00:30,  4.12it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  69%|██████▉   | 173/250 [00:30,  4.91it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  70%|██████▉   | 174/250 [00:30,  5.68it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  70%|███████   | 175/250 [00:30,  6.36it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  70%|███████   | 176/250 [00:30,  6.97it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  71%|███████   | 177/250 [00:31,  6.45it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  71%|███████   | 178/250 [00:31,  5.41it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  72%|███████▏  | 179/250 [00:31,  5.44it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  73%|███████▎  | 182/250 [00:31,  6.98it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  73%|███████▎  | 183/250 [00:32,  6.57it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  74%|███████▎  | 184/250 [00:32,  5.72it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  74%|███████▍  | 185/250 [00:32,  5.15it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  74%|███████▍  | 186/250 [00:32,  5.87it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  75%|███████▍  | 187/250 [00:32,  5.25it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  75%|███████▌  | 188/250 [00:33,  5.92it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  76%|███████▌  | 189/250 [00:33,  6.40it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  76%|███████▌  | 190/250 [00:33,  5.43it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  76%|███████▋  | 191/250 [00:33,  6.20it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  77%|███████▋  | 192/250 [00:33,  5.36it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  78%|███████▊  | 194/250 [00:33,  7.44it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  78%|███████▊  | 195/250 [00:34,  6.04it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  78%|███████▊  | 196/250 [00:34,  5.31it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  79%|███████▉  | 197/250 [00:34,  5.38it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  80%|███████▉  | 199/250 [00:34,  7.31it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  80%|████████  | 200/250 [00:35,  6.07it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  80%|████████  | 201/250 [00:35,  6.67it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  81%|████████  | 202/250 [00:35,  7.20it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  82%|████████▏ | 204/250 [00:35,  9.08it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  82%|████████▏ | 205/250 [00:35,  6.95it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  82%|████████▏ | 206/250 [00:35,  7.41it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  83%|████████▎ | 207/250 [00:35,  6.74it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  83%|████████▎ | 208/250 [00:36,  5.62it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  84%|████████▎ | 209/250 [00:36,  4.98it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  84%|████████▍ | 210/250 [00:36,  3.34it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  84%|████████▍ | 211/250 [00:37,  4.11it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  85%|████████▍ | 212/250 [00:37,  4.88it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  85%|████████▌ | 213/250 [00:37,  4.49it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  86%|████████▋ | 216/250 [00:37,  7.46it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  87%|████████▋ | 217/250 [00:37,  7.72it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  87%|████████▋ | 218/250 [00:37,  8.04it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  88%|████████▊ | 219/250 [00:37,  8.30it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  88%|████████▊ | 220/250 [00:38,  7.43it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  88%|████████▊ | 221/250 [00:38,  7.82it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  89%|████████▉ | 222/250 [00:38,  8.12it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  89%|████████▉ | 223/250 [00:38,  7.12it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  90%|█████████ | 226/250 [00:39,  5.49it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  91%|█████████ | 227/250 [00:39,  5.04it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  91%|█████████ | 228/250 [00:39,  4.73it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  92%|█████████▏| 229/250 [00:39,  5.37it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  92%|█████████▏| 230/250 [00:40,  5.32it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  92%|█████████▏| 231/250 [00:40,  4.86it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  93%|█████████▎| 232/250 [00:40,  4.51it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  93%|█████████▎| 233/250 [00:40,  4.32it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  94%|█████████▎| 234/250 [00:41,  4.27it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  94%|█████████▍| 235/250 [00:41,  4.65it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  94%|█████████▍| 236/250 [00:41,  4.51it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  95%|█████████▍| 237/250 [00:41,  5.38it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  95%|█████████▌| 238/250 [00:41,  6.16it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  96%|█████████▌| 240/250 [00:41,  6.41it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  96%|█████████▋| 241/250 [00:42,  5.90it/s, step size=4.44e-01, acc. prob=0.987]
Sample:  97%|█████████▋| 242/250 [00:42,  5.57it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  97%|█████████▋| 243/250 [00:42,  4.91it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  98%|█████████▊| 244/250 [00:42,  4.49it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  98%|█████████▊| 245/250 [00:43,  3.86it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  98%|█████████▊| 246/250 [00:43,  3.41it/s, step size=4.44e-01, acc. prob=0.986]
Sample:  99%|█████████▉| 248/250 [00:43,  4.25it/s, step size=4.44e-01, acc. prob=0.986]
Sample: 100%|█████████▉| 249/250 [00:44,  4.19it/s, step size=4.44e-01, acc. prob=0.986]
Sample: 100%|██████████| 250/250 [00:44,  4.12it/s, step size=4.44e-01, acc. prob=0.986]
Sample: 100%|██████████| 250/250 [00:44,  5.62it/s, step size=4.44e-01, acc. prob=0.986]
</pre></div>
</div>
</section>
<section id="posterior-predictive-checks">
<h2>Posterior Predictive Checks<a class="headerlink" href="#posterior-predictive-checks" title="Link to this heading">¶</a></h2>
<p>After obtaining the posterior samples, we perform posterior predictive checks.
This step is crucial to evaluate the performance and validity of our probabilistic model.</p>
<p>Sample from posterior predictive and visualize</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">posterior_samples</span> <span class="o">=</span> <span class="n">mcmc</span><span class="o">.</span><span class="n">get_samples</span><span class="p">()</span>
<span class="n">posterior_predictive</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">posterior_samples</span><span class="p">)(</span><span class="n">y_obs_list</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_pyro</span><span class="p">(</span><span class="n">posterior</span><span class="o">=</span><span class="n">mcmc</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span> <span class="n">posterior_predictive</span><span class="o">=</span><span class="n">posterior_predictive</span><span class="p">)</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_01_thickness_problem_gempy_004.png" srcset="../../_images/sphx_glr_01_thickness_problem_gempy_004.png" alt="$\mu_{top}$, $\mu_{top}$" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/leguark/.virtualenvs/gempy_dependencies/lib/python3.10/site-packages/arviz/data/io_pyro.py:158: UserWarning: Could not get vectorized trace, log_likelihood group will be omitted. Check your model vectorization or set log_likelihood=False
  warnings.warn(
</pre></div>
</div>
</section>
<section id="density-plot-of-posterior-predictive">
<h2>Density Plot of Posterior Predictive<a class="headerlink" href="#density-plot-of-posterior-predictive" title="Link to this heading">¶</a></h2>
<p>A density plot provides a visual representation of the distribution of the
posterior predictive checks. It helps in comparing the prior and posterior distributions
and in assessing the impact of our observed data on the model.</p>
<p>Plot density of posterior predictive and prior predictive</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_density</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">posterior_predictive</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">prior_predictive</span><span class="p">],</span>
    <span class="n">shade</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span>
    <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\mu_</span><span class="si">{thickness}</span><span class="s1">$&#39;</span><span class="p">],</span>
    <span class="n">data_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Posterior Predictive&quot;</span><span class="p">,</span> <span class="s2">&quot;Prior Predictive&quot;</span><span class="p">],</span>
    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">default_red</span><span class="p">,</span> <span class="n">default_blue</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_01_thickness_problem_gempy_005.png" srcset="../../_images/sphx_glr_01_thickness_problem_gempy_005.png" alt="$\mu_{thickness}$" class = "sphx-glr-single-img"/><p>Plot spagetti</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">p2d</span> <span class="o">=</span> <span class="n">plot_geo_setting_well</span><span class="p">(</span><span class="n">geo_model</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">show_lith</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">199</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">modify_surface_points</span><span class="p">(</span>
        <span class="n">geo_model</span><span class="o">=</span><span class="n">geo_model</span><span class="p">,</span>
        <span class="nb">slice</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">Z</span><span class="o">=</span> <span class="n">geo_model</span><span class="o">.</span><span class="n">input_transform</span><span class="o">.</span><span class="n">apply_inverse</span><span class="p">(</span>
            <span class="n">points</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\mu_</span><span class="si">{top}</span><span class="s1">$&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]]))[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="n">gp</span><span class="o">.</span><span class="n">compute_model</span><span class="p">(</span><span class="n">geo_model</span><span class="p">)</span>

    <span class="n">plot_regular_grid_contacts</span><span class="p">(</span>
        <span class="n">gempy_model</span><span class="o">=</span><span class="n">geo_model</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">p2d</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">slicer_data</span><span class="o">=</span><span class="n">p2d</span><span class="o">.</span><span class="n">section_data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">slicer_data</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="n">geo_model</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">regular_grid</span><span class="o">.</span><span class="n">resolution</span><span class="p">,</span>
        <span class="n">only_faults</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>
    <span class="p">)</span>

<span class="n">p2d</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_01_thickness_problem_gempy_006.png" srcset="../../_images/sphx_glr_01_thickness_problem_gempy_006.png" alt="Cell Number: mid Direction: y" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
Setting Backend To: AvailableBackends.numpy
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 56.217 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-04-probabilistic-modeling-01-thickness-problem-gempy-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c6e7636b7672db18e241e4f58389664c/01_thickness_problem_gempy.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">01_thickness_problem_gempy.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a51ee1dc5ae51d9e0b87a1974006e940/01_thickness_problem_gempy.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">01_thickness_problem_gempy.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/vector-logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">Vector Geology</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Galleries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Vector Geology Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../external/external_examples.html">Bayesian Inference Theory</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01_readers/index.html">Readers and Parsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_structural_modeling/index.html">Structural Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_forward_engines/index.html">GeoPhysics and Inversion</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Probabilistic Modeling</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.2 - Including GemPy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#complex-probabilistic-model">Complex probabilistic model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-the-geological-model">Creating the Geological Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-the-model">Configuring the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-a-custom-grid">Setting up a Custom Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-the-initial-geological-setting">Plotting the Initial Geological Setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpolating-the-initial-guess">Interpolating the Initial Guess</a></li>
<li class="toctree-l3"><a class="reference internal" href="#probabilistic-geomodeling-with-pyro">Probabilistic Geomodeling with Pyro</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-the-probabilistic-model">Defining the Probabilistic Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-prior-sampling-and-visualization">Running Prior Sampling and Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sampling-from-the-posterior-using-mcmc">Sampling from the Posterior using MCMC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#posterior-predictive-checks">Posterior Predictive Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#density-plot-of-posterior-predictive">Density Plot of Posterior Predictive</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="02_model_1_bayesian.html">Probabilistic Inversion Example: Geological Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../05_petrophysics/index.html">Petrophysical Data Integration and Modeling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintenance.html">Maintenance</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023-2024, Vector Geology Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/examples/04_probabilistic_modeling/01_thickness_problem_gempy.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>